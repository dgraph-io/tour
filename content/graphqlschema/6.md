+++
date = "2017-05-01T10:41:33+10:00"
next = "/graphqlschema/7"
prev = "/graphqlschema/5"
title = "Exercise: Integrating existing data"
weight = 6
course = 3
courseName = "Schema"
type = "graphql"
+++

Previous lessons added a new schema and loaded company data. This lesson
integrates the pre-existing friends-and-pets dataset with the company data.

Referencing an existing company by name in a mutation creates a new `Company`
node, as a previous lesson demonstrated. The generated GraphQL API lets you
search for a node, then update it by linking to existing or new nodes.

The example mutation searches for `Person` nodes by `xid` and updates them by
setting edges to existing people, new people, and a new company. Widening the
filter parameters lets the update mutation modify nodes in bulk.

The returned payload includes `numUids`, a count of nodes created or updated, and
the filtered nodes themselves. Field selection on these nodes shows their
post-mutation state.

Because updates can link to pre-existing nodes, you can traverse those nodes to
reach other nodes not provided in the update input.

A mutation can set predicate values in similar fashion as it sets edges.

**Something to try**: Update the person with `xid` equal to "karl" and set the
age to "42".

{{% notice "note" %}}
Dgraph generates UIDs dynamically, so the `id` field values differ across
Dgraph instances. This lesson uses `xid` instead of `id` for that reason.
{{% /notice %}}

{{% expandable %}}

```
mutation {
  updatePerson(input: {
    filter: {
      # your filter(s) here
      xid: { eq: "karl" }
    }
    set: {
      # edges and predicates to add/update here
      age: 42
    }
  }) {
    numUids #this is the number of new nodes updated or created
    person {
      # field selection here
      xid
      age
    }
  }
}
```

{{% /expandable %}}

**Something to try**: The mutation above set Alice as the manager of Frank and
Karl and set Alice's manager as Bob, but did not link Bob, Frank, or Karl to
"Acme Corp." Update Acme Corp's employees to include Bob, Frank, and Karl.

{{% expandable %}} Update Acme Corp's employees: mutation { updateCompany(input:
{ filter: { name: { eq: "Acme Corp." } } set: { employees: [ { xid: "bob" } {
xid: "frank" } { xid: "karl" } ] } }) { numUids company { id name employees {
xid name } } } } {{% /expandable %}}

